(function(e){e.fn.raty=function(w){options=e.extend({},e.fn.raty.defaults,w);if(this.attr("id")===undefined){c("Invalid selector!");return;}if(options.number>20){options.number=20;}else{if(options.number<0){options.number=0;}}if(options.path.substring(options.path.length-1,options.path.length)!="/"){options.path+="/";}$global=e(this);var n=$global,s=$global.attr("id"),q=options.path,j=options.cancelOff,r=options.cancelOn,m=options.showHalf,g=options.starHalf,x=options.starOff,u=options.starOn,l=options.onClick,k=0,p="";if(!isNaN(options.start)&&options.start>0){k=(options.start>options.number)?options.number:options.start;}for(var t=1;t<=options.number;t++){p=(options.number<=options.hintList.length&&options.hintList[t-1]!==null)?options.hintList[t-1]:t;starFile=(k>=t)?u:x;n.append('<img id="'+s+"-"+t+'" src="'+q+starFile+'" alt="'+t+'" title="'+p+'" class="'+s+'"/>').append((t<options.number)?"&nbsp;":"");}n.append('<input id="'+s+'-score" type="hidden" name="'+options.scoreName+'"/>');e("#"+s+"-score").val(k);if(m){var v=e("input#"+s+"-score").val(),y=Math.ceil(v),o=(y-v).toFixed(1);if(o>=0.3&&o<=0.7){y=y-0.5;e("img#"+s+"-"+Math.ceil(y)).attr("src",q+g);}else{if(o>=0.8){y--;}else{e("img#"+s+"-"+y).attr("src",q+u);}}}if(!options.readOnly){if(options.showCancel){var h='<img src="'+q+options.cancelOff+'" alt="x" title="'+options.cancelHint+'" class="button-cancel"/>';if(options.cancelPlace=="left"){n.prepend(h+"&nbsp;");}else{n.append("&nbsp;").append(h);}n.css("width",options.number*20+20);e("#"+s+" img.button-cancel").live("mouseenter",function(){e(this).attr("src",q+r);e("img."+s).attr("src",q+x);}).live("mouseleave",function(){e(this).attr("src",q+j);e("img."+s).trigger("mouseout");}).live("click",function(){e("input#"+s+"-score").val(0);if(l){l.apply(n,[0]);}});}else{n.css("width",options.number*20);}e("img."+s).live("mouseenter",function(){var z=e("img."+s).length;for(var A=1;A<=z;A++){if(A<=this.alt){e("img#"+s+"-"+A).attr("src",q+u);}else{e("img#"+s+"-"+A).attr("src",q+x);}}}).live("click",function(){e("input#"+s+"-score").val(this.alt);if(l){l.apply(n,[this.alt]);}});n.live("mouseleave",function(){var E=e(this).attr("id"),A=e("img."+E).length,D=e("input#"+E+"-score").val();for(var B=1;B<=A;B++){if(B<=D){e("img#"+E+"-"+B).attr("src",q+u);}else{e("img#"+E+"-"+B).attr("src",q+x);}}if(m){var D=e("input#"+E+"-score").val(),z=Math.ceil(D),C=(z-D).toFixed(1);if(C>=0.3&&C<=0.7){z=z-0.5;e("img#"+E+"-"+Math.ceil(z)).attr("src",q+g);}else{if(C>=0.8){z--;}else{e("img#"+E+"-"+z).attr("src",q+u);}}}}).css("cursor","pointer");}else{p=(options.number<=options.hintList.length&&options.hintList[k-1]!==null)?options.hintList[k-1]:k;n.css("cursor","default").attr("title",p).children("img").attr("title",p);}return n;};e.fn.raty.defaults={cancelHint:"cancel this rating!",cancelOff:"cancel-off.png",cancelOn:"cancel-on.png",cancelPlace:"left",hintList:["bad","poor","regular","good","gorgeous"],number:5,path:"img/",readOnly:false,scoreName:"score",showCancel:false,showHalf:false,starHalf:"star-half.png",start:0,starOff:"star-off.png",starOn:"star-on.png"};e.fn.raty.readOnly=function(g){if(g){e("img."+$global.attr("id")).die();$global.css("cursor","default").die();}else{d();f();b();$global.css("cursor","pointer");}return e.fn.raty;};e.fn.raty.start=function(g){a(g);return e.fn.raty;};e.fn.raty.click=function(h){var g=(h>=options.number)?options.number:h;a(g);if(options.onClick){options.onClick.apply($this,[g]);}else{c('You should add the "onClick: function() {}" option.');}return e.fn.raty;};function d(){var g=$global.attr("id");e("img."+g).live("mouseenter",function(){var h=e("img."+g).length;for(var j=1;j<=h;j++){if(j<=this.alt){e("img#"+g+"-"+j).attr("src",options.path+options.starOn);}else{e("img#"+g+"-"+j).attr("src",options.path+options.starOff);}}});}function f(){$global.live("mouseleave",function(){var k=e(this).attr("id"),g=e("img."+k).length,j=e("input#"+k+"-score").val();for(var h=1;h<=g;h++){if(h<=j){e("img#"+k+"-"+h).attr("src",options.path+options.starOn);}else{e("img#"+k+"-"+h).attr("src",options.path+options.starOff);}}});}function b(){var g=$global.attr("id");e("img."+g).live("click",function(){e("input#"+g+"-score").val(this.alt);});}function a(k){var j=$global.attr("id"),g=e("img."+j).length;e("input#"+j+"-score").val(k);for(var h=1;h<=g;h++){if(h<=k){e("img#"+j+"-"+h).attr("src",options.path+options.starOn);}else{e("img#"+j+"-"+h).attr("src",options.path+options.starOff);}}}function c(g){if(window.console&&window.console.log){window.console.log(g);}}})(jQuery);